Fs = 1000; % Частота дискретизации, Гц
fs = 25; % Граничная частота полосы подавления, Гц
fp = 50; % Граничная частота полосы пропускания, Гц
As = 40; % Затухание в полосе подавления, дБ

delta_f = abs(fs - fp); % Ширина полосы перехода
delta_f_norm = delta_f / Fs; % Нормированная ширина полосы перехода
N = round(3.3 / delta_f_norm); % Длина фильтра
if mod(N, 2) == 0 % Если N четное, делаем его нечетным
    N = N + 1;
end
fc = fs + delta_f / 2; % Реальная частота среза
fc_norm = fc / (Fs / 2); % Нормированная частота среза

wn = hamming(N); % Весовая функция Хэмминга
hn = fir1(N - 1, fc_norm, 'high', wn); % Коэффициенты фильтра

figure;
stem(hn);
title('Импульсная характеристика фильтра');
grid on;

M = 2^9; % Количество точек данных
[H, f] = freqz(hn, 1, M, Fs);
figure;
plot(f, abs(H));
title('АЧХ фильтра');
grid on;

% Параметры входных сигналов
f1 = 10; % Частота первой гармоники, Гц
f2 = 60; % Частота второй гармоники, Гц
A1 = 1; % Амплитуда первой гармоники
A2 = 0.5; % Амплитуда второй гармоники
T = 1 / Fs; % Шаг дискретизации
t = (0:M-1) * T; % Вектор времени
x = A1 * sin(2 * pi * f1 * t) + A2 * sin(2 * pi * f2 * t); % Входной сигнал

% Моделирование прохождения сигнала через фильтр
y = conv(x, hn, 'same'); % Выходной сигнал

figure;
plot(t, x, 'r', t, y, 'b');
title('Входной и выходной сигналы');
grid on;

Hx = fft(x, M); % Преобразование Фурье входного сигнала
Hy = fft(y, M); % Преобразование Фурье выходного сигнала
f = (0:M-1) * (Fs / M); % Вектор частот

figure;
plot(f, abs(Hx), 'r');
title('Амплитудный спектр входного сигнала');
grid on;

figure;
plot(f, abs(Hy), 'b');
title('Амплитудный спектр выходного сигнала');
grid on;
